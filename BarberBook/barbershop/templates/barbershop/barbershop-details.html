{% extends 'base.html' %}
{% load static %}
{% load barbershop_custom_filters %}

{% block title %}
Barberbook Barbershop Details Page
{% endblock %}

{% block content %}
    <h1>{{ request.user }}</h1>
    <div class="barbershop-details-wrapper">
        <div class="barbeshop-details">
            <h1>Barbershop Details</h1>
                {% if object.barbershop_picture %}
                    <img src="{{ object.barbershop_picture.url }}" class="profile-picture" alt="barbershop-profile_picture">
                {% else %}
                    <img src="{% static 'images/barbershop-default-profile-picture.jpg' %}" alt="barber_default_profile_picture" class="profile-picture">
                {% endif %}
            <ul>
                <li>Email: {{ object.user.email }}</li>
                <li>Name: {{ object.name }}</li>
                <li>Address: {{ object.address }}</li>
                <li>City: {{ object.city }}</li>
                <li>About: {{ object.about }}</li>
                <li>Barbers: {{ object.barber_set.count }}</li>

            </ul>
            {% if object.pk == request.user.pk %}
                <a href="{% url 'edit-barbershop' slug=object.slug %}" class="link-button">Edit Profile</a>
                <a href="{% url 'delete-account' %}" class="link-button">Delete Profile</a>
            {% endif %}
        </div>

        <div class="services">
            <h2>Services</h2>
            <ul>
                {% for service in object.barbershopservice_set.all %}
                    {% if object.pk == request.user.pk %}
                        <li><a href="{% url 'service-details' slug=object.slug pk=service.pk %}">{{ service.service_name }} - {{ service.price }} lv.</a></li>
                    {% else %}
                        <li>{{ service.service_name }} - {{ service.price }} lv.</li>
                    {% endif %}
                {% empty %}
                    <li>This barbershop has no services yet</li>
                {% endfor %}
            </ul>
            {% if object.pk == request.user.pk %}
                <a href="{% url 'create-service' slug=object.slug %}" class="link-button">Add New Service</a>
            {% endif %}
        </div>

        <div class="barbers-list">
            <h2>Barbers</h2>
            <ul>
                {% for barber in object.barber_set.all %}
                    <li><a href="{% url 'barber-details' pk=barber.pk %}">{{ barber.name }}</a></li>
                {% empty %}
                    <li>This barbershop has no barbers</li>
                {% endfor %}
            </ul>
            {% if object.pk == request.user.pk %}
                <a href="{% url 'create-barber' %}" class="link-button">Add New Barber</a>
            {% endif %}
        </div>
    </div>
    <div class="working-hours">
        <h2>Working Hours</h2>
        <ul>
            {% for weekday in object.barbershopworkinghours_set.all %}
                {% if object.pk == request.user.pk %}
                    <a href="{% url 'working-hours-details' slug=object.slug pk=weekday.pk %}">
                        {% if weekday.start_time and weekday.end_time %}
                            <li>{{ weekday.day|weekday_name }}: {{ weekday.start_time }} - {{ weekday.end_time }}</li>
                        {% else %}
                            <li>{{ weekday.day|weekday_name }}: <img src="{% static 'images/closed_sign.jpg'%}" alt="closed" class="closed-sign"></li>
                        {% endif %}
                    </a>
                {% else %}
                    {% if weekday.start_time and weekday.end_time %}
                        <li>{{ weekday.day|weekday_name }}: {{ weekday.start_time }} - {{ weekday.end_time }}</li>
                    {% else %}
                        <li>{{ weekday.day|weekday_name }}: <img src="{% static 'images/closed_sign.jpg'%}" alt="closed" class="closed-sign"></li>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </ul>
    </div>



{% endblock %}